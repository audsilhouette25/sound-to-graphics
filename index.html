<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>IML Audio Workstation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="canvas-wrapper"></div>

    <div id="ui-container">
        <div id="lang-switch-container">
            <button id="btn-lang" onclick="toggleLanguage()">π‡°π‡· / π‡Ίπ‡Έ</button>
        </div>

        <div class="steps-wrapper">
            <div class="step-box">
                <h3 data-key="title_step1">1. μ¤λ””μ¤ μ…λ ¥</h3>
                <input type="file" id="file-input" accept="audio/*" style="display:none">
                <button onclick="document.getElementById('file-input').click()" data-key="btn_file">π“ νμΌ μ°ΎκΈ°</button>
                <button id="btn-record" onclick="toggleRecord()" data-key="btn_mic">π¤ λ§μ΄ν¬ λ…Ήμ</button>
                
                <div id="confirm-area" class="hidden" style="margin-top:10px; border-top:1px solid #444; padding-top:10px;">
                    <span id="file-name" style="font-size:0.8em; color:#00ffcc;"></span>
                    <button id="btn-confirm" onclick="startAnalysis()" style="background:#00ffcc; color:black; margin-top:5px;" data-key="btn_analyze">
                        π€ λ¶„μ„ μ‹μ‘
                    </button>
                </div>
            </div>

            <div id="player-area" class="step-box hidden">
                <h3 data-key="title_step2">2. κµ¬κ°„ μ„ νƒ</h3>
                <audio id="audio-player" controls style="width:100%; margin-bottom:5px; height: 30px;"></audio>
                
                <div id="timeline-container">
                    <div id="timeline-bar">
                        <div id="selection-box"></div> <div id="playhead"></div>
                    </div>
                    <div style="font-size:0.7em; color:#888; margin-top:5px; display:flex; justify-content:space-between;">
                        <span data-key="guide_drag">λ“λκ·Έν•μ—¬ κµ¬κ°„ μ„ νƒ</span>
                        <button onclick="clearSelection()" style="width:auto; padding:2px 8px; font-size:10px; background:#555;" data-key="btn_clear">ν•΄μ </button>
                    </div>
                </div>
            </div>

            <div id="edit-panel" class="step-box hidden" style="border-color: #ff0055;">
                <h3 style="color:#ff0055;" data-key="title_step3">3. κµ¬κ°„ μμ •</h3>
                
                <div class="control-row shapes">
                    <button class="shape-btn" id="s-0" onclick="setOverrideShape(0)">Jagged</button>
                    <button class="shape-btn" id="s-1" onclick="setOverrideShape(1)">Fluid</button>
                    <button class="shape-btn" id="s-2" onclick="setOverrideShape(2)">Granular</button>
                </div>

                <div class="sliders-grid">
                    <div class="control-row"><label data-key="lbl_scale">ν¬κΈ°</label><input type="range" id="sl-scale" min="0" max="1" step="0.01"></div>
                    <div class="control-row"><label data-key="lbl_opacity">ν¬λ…λ„</label><input type="range" id="sl-opacity" min="0" max="1" step="0.01"></div>
                    <div class="control-row"><label data-key="lbl_definition">μ •λ°€λ„</label><input type="range" id="sl-definition" min="0" max="1" step="0.01"></div>
                    <div class="control-row"><label data-key="lbl_density">μ§κ°</label><input type="range" id="sl-density" min="0" max="1" step="0.01"></div>
                </div>

                <button onclick="applyOverrideToSelection()" style="background:#ff0055; color:white; font-weight:bold; margin-top: 5px;" data-key="btn_apply">
                    β¨ μ μ© (Apply)
                </button>
            </div>

            <div id="train-panel" class="step-box hidden" style="border-color: #7700ff;">
                <h3 style="color:#7700ff;" data-key="title_step4">4. ν•™μµ</h3>
                <p style="font-size:0.75em; color:#ccc; margin-bottom:10px;" data-key="desc_train">
                    μμ • κ²°κ³Όλ¥Ό ν•™μµμ‹μΌ κ°μΈν™”ν•©λ‹λ‹¤.
                </p>
                <button id="btn-train" onclick="trainModel()" style="background:#7700ff;" data-key="btn_train">
                    π§  AI λ¨λΈ ν•™μµ
                </button>
            </div>
        </div>
    </div>

    <script src="sketch.js"></script>
</body>
</html>